<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Главная</title>
    <link rel="icon" href="../img/miac_short.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/same.css">
</head>
<body>

<header id="header" class="header">
    <div class="container header__container">
        <a href="https://spbmiac.ru/" class="logo_top">
            <img class="logo__img" src="../img/miac.png" alt="Логотип">
        </a>
        <nav class="menu_top">
            <ul class="menu__list">
                <li id="UserFIO" class="menu__item"></li>
                <li id="UserGroups" class="menu__item"></li>
                <li><a href="#" id="changePasswordLink">Сменить пароль</a></li>
            </ul>
        </nav>
    </div>
</header>

<div id="changePasswordModal" class="modal-window" style="display: none;" >
    <div class="modal-change">
      <span class="close-button-change" onclick="closeModal()">&times;</span>
      <h2>Смена пароля</h2>
      <input type="password" id="oldPassword" placeholder="Старый пароль">
      <input type="password" id="newPassword" placeholder="Новый пароль">
      <input type="password" id="confirmPassword" placeholder="Подтверждение">
      <button onclick="changePassword()">Сменить пароль</button>
    </div>
  </div>

  <script>
    function openModal() {
      var modal = document.getElementById("changePasswordModal");
      modal.style.display = "flex";
  }
    
    // Функция для закрытия модального окна
  function closeModal() {
      var modal = document.getElementById("changePasswordModal");
      modal.style.display = "none";
  }
    
    // Функция для смены пароля
  function changePassword() {
      var oldPassword = document.getElementById("oldPassword").value;
      var newPassword = document.getElementById("newPassword").value;
      var confirmPassword = document.getElementById("confirmPassword").value;
    
      // Проверяем, что новый пароль и подтверждение нового пароля совпадают
    
  if (newPassword !== confirmPassword) {
      alert("New password and confirmation do not match.");
      return;
  }
    
  const url = `${config.ApiUrl}/user_update_password`;
  
  const body = {
        "old_password": "1245",
        "new_password": "123"
  };
    
  const headers = {
        "Content-Type": "application/json",
        "Authorization": token
  };
    
  fetch(url, {
        method: 'PUT',
        headers: {
          'Content-Type':'application/json',
          'Authorization': localStorage.getItem('authToken')
        },
        body: JSON.stringify(data)
  })
        .then(response => response.json())
        .then(data => console.log(data))
        .catch(error => console.error(error));
    
      // Вместо этого мы просто выведем сообщение в консоль
        console.log("Old Password:", oldPassword);
        console.log("New Password:", newPassword);
    
      // Очищаем поля ввода после успешной смены пароля
        document.getElementById("oldPassword").value = "";
        document.getElementById("newPassword").value = "";
        document.getElementById("confirmPassword").value = "";
    
        alert("Password changed successfully!");
        closeModal(); // Закрываем модальное окно после успешной смены пароля
  }
    
    // Привязываем функцию openModal к ссылке
    document.getElementById("changePasswordLink").onclick = function(event) {
      event.preventDefault(); // Предотвращаем переход по ссылке
      openModal();
  };
  </script>


  <h1 class="welcome">Главная страница</h1>
  <!-- <p class="welcome-descr">Это главная страница вашего приложения.</p> -->


<aside class="aside_slidebar sidebar">
    <div class="logo">
    </div>
    <ul class="links">
      <h4>Основные</h4>
      <li>
        <span class="material-symbols-outlined">dashboard</span>
        <a href="main.html">Главная</a>
      </li>
      <li>
        <span class="material-symbols-outlined">person</span>
        <a href="users.html">Пользователи</a>
      </li>
      <!-- <li>
        <span class="material-symbols-outlined">flag</span>
        <a href="#">Reports</a>
      </li> -->
      <hr>
      <h4>Системные</h4>
      <li>
        <span class="material-symbols-outlined">ambient_screen</span>
        <a href="file.html">Файлы</a>
      </li>
      <li>
        <span class="material-symbols-outlined">monitoring</span>
        <a href="directories.html">Директории</a>
      </li>
      <li>
        <span class="material-symbols-outlined">flag</span>
        <a href="commands.html">Команды</a>
      </li>
      <!-- <li>
        <span class="material-symbols-outlined">pacemaker</span>
        <a href="#">Theme Maker</a>
      </li> -->
      <hr>
      <h4>Личное</h4>
      <li>
        <span class="material-symbols-outlined">mail</span>
        <a href="https://mail.ru/?utm_source=portal&utm_medium=logo_portal_navigation&utm_campaign=mail.ru&mt_sub5=142510&mt_sub1=mail.ru&mt_click_id=mt-o4lsx4-1710880334-89398493">Почта</a>
      </li>
      <li class="logout-link">
        <span class="material-symbols-outlined">logout</span>
          <a id="logoutButton" href="#">Выход</a>        
      </li>
    </ul>
  </aside>
  
<script type="module" src="../js/main.js"></script>
<script type="module" src="../js/logout.js"></script>



</body>
</html>


